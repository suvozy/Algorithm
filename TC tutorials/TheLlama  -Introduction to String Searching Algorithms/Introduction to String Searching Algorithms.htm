<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">





<title>Algorithm Tutorials</title>


<script language="JavaScript" type="text/javascript" src="Introduction%20to%20String%20Searching%20Algorithms_files/tcscript.js"></script><link type="image/x-icon" rel="shortcut icon" href="http://www.topcoder.com/i/favicon.ico">






<link type="text/css" rel="stylesheet" href="Introduction%20to%20String%20Searching%20Algorithms_files/style.css">
<link type="text/css" rel="stylesheet" href="Introduction%20to%20String%20Searching%20Algorithms_files/coders.css">
<link type="text/css" rel="stylesheet" href="Introduction%20to%20String%20Searching%20Algorithms_files/tcStyles20080219.css">
<link type="text/css" rel="stylesheet" href="Introduction%20to%20String%20Searching%20Algorithms_files/jobsRemix.css">


<script language="JavaScript" src="Introduction%20to%20String%20Searching%20Algorithms_files/print.js"></script>
<style type="text/css">
.code
{
   width: 550;
   padding: 10px;
   margin: 20px;
   color: #333;
   font-size: 11px;
   font-weight: normal;
   line-height: 14px;
   background-color: #EEEEEE;
   border: 1px solid #999;
}
</style>
</head><body>
<div id="onTop">
    





<script type="text/javascript" src="Introduction%20to%20String%20Searching%20Algorithms_files/popup.js"></script>

<div id="shortcutBar">
    <div class="icon"><a href="http://www.topcoder.com/tc"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/scHome.png" alt="" onmouseover="postPopUpText('globalPopupText','Home'); popUp(this,'globalPopup');" onmouseout="popHide()"></a></div>
    <div class="icon"><a href="javascript:arena();"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/scAlgo.png" alt="" onmouseover="postPopUpText('globalPopupText','Algorithm Competitions'); popUp(this,'globalPopup');" onmouseout="popHide()"></a></div>
    <div class="icon"><a href="http://www.topcoder.com/tc?module=ActiveContests&amp;pt=23"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/scConceptualization.png" alt="" onmouseover="postPopUpText('globalPopupText','Software Conceptualization Competitions'); popUp(this,'globalPopup');" onmouseout="popHide()"></a></div>
    <div class="icon"><a href="http://www.topcoder.com/tc?module=ActiveContests&amp;pt=6"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/scSpecification.png" alt="" onmouseover="postPopUpText('globalPopupText','Software Specification Competitions'); popUp(this,'globalPopup');" onmouseout="popHide()"></a></div>
    <div class="icon"><a href="http://www.topcoder.com/tc?module=ActiveContests&amp;pt=7"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/scArchitecture.png" alt="" onmouseover="postPopUpText('globalPopupText','Software Architecture Competitions'); popUp(this,'globalPopup');" onmouseout="popHide()"></a></div>
    <div class="icon"><a href="http://www.topcoder.com/tc?module=ViewActiveContests&amp;ph=112"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/scDesign.png" alt="" onmouseover="postPopUpText('globalPopupText','Component Design Competitions'); popUp(this,'globalPopup');" onmouseout="popHide()"></a></div>
    <div class="icon"><a href="http://www.topcoder.com/tc?module=ViewActiveContests&amp;ph=113"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/scDevelopment.png" alt="" onmouseover="postPopUpText('globalPopupText','Component Development Competitions'); popUp(this,'globalPopup');" onmouseout="popHide()"></a></div>

    <div class="icon"><a href="http://www.topcoder.com/tc?module=ViewAssemblyActiveContests"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/scAssembly.png" alt="" onmouseover="postPopUpText('globalPopupText','Software Assembly Competitions'); popUp(this,'globalPopup');" onmouseout="popHide()"></a></div>
    <div class="icon"><a href="javascript:arena();"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/scTCHS.png" alt="" onmouseover="postPopUpText('globalPopupText','High School Competitions'); popUp(this,'globalPopup');" onmouseout="popHide()"></a></div>
    <div class="icon"><a href="http://www.topcoder.com/longcontest/?module=ViewActiveContests"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/scMarathon.png" alt="" onmouseover="postPopUpText('globalPopupText','Marathon Matches'); popUp(this,'globalPopup');" onmouseout="popHide()"></a></div>
    <div class="icon"><a href="http://studio.topcoder.com/?module=ViewActiveContests"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/scStudio.png" alt="" onmouseover="postPopUpText('globalPopupText','TopCoder Studio Competitions'); popUp(this,'globalPopup');" onmouseout="popHide()"></a></div>
</div>

<div id="globalPopup" class="popUp"><div id="globalPopupText"></div></div>


<div style="position: absolute; right: 0px; top: 31px;"><a href="http://www.topcoder.com/tc?module=MyHome"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/myTopCoder.png" alt="My TopCoder" style="display: block;"></a></div>


<div style="margin: 0px 290px 0px 280px;" align="center">
   <div id="outerLogo">
      <div id="innerLogo">
      <a href="http://www.topcoder.com/"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/topcoder.gif" alt="TopCoder" style="display: block;"></a>
      </div>
   </div>
</div>

<div class="memberCountBox">
Member Count: 186,120 - 


February 19, 2009

&nbsp;<a class="gMetal" href="javascript:tcTime()">[Get Time]</a>
</div>

<div class="topBar">
    <div style="margin: 5px 0px 0px; float: right;">
        
            Hello,&nbsp;<a href="http://www.topcoder.com/tc?module=MemberProfile&amp;cr=22764304" class="coderTextWhite">bitsits</a>
            
                | <a class="gMetal" href="http://www.topcoder.com/tc?module=Logout">Logout</a>
            
        
    </div>
</div>
</div>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tbody><tr valign="top">
        <!-- Left Column Begins-->
        <td id="onLeft" width="180">






    
    








<script language="JavaScript" type="text/javascript" src="Introduction%20to%20String%20Searching%20Algorithms_files/arena.js"></script>


<script language="JavaScript" type="text/javascript">
<!--
function toggleMenu(menuTitle,menuID){
   var menu = document.getElementById(menuID);
   if(menu.style.display == 'block') menu.className = 'CLOSED';
   else if(menu.className == 'OPEN' && menu.style.display != 'none') menu.className = 'CLOSED';
   else {
      menu.className = 'OPEN';
   }
   if(menuTitle.blur)menuTitle.blur();
   if(menuTitle.className == 'exp') menuTitle.className = 'exp_ed';
   else menuTitle.className = 'exp';
   return;
}
function flipMenu(myMenuName){
   var menuName = document.getElementById(myMenuName);
   menuName.className = 'exp_ed';
}

// -->
</script>

<div style="padding: 0px;"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/leftnav_top.gif" alt=""></div>
<div id="navbar">
    
<ul>
<li class="exp_ed"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_competitions')">Competitions</a>
<ul id="m_competitions" class="OPEN">
<li><a href="http://www.topcoder.com/tc">Home</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_competitor_stats')">The Tops</a>
<ul id="m_competitor_stats">
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_top_rated_competitors')">Top Ranked</a>
<ul id="m_top_rated_competitors">
<li><a href="http://www.topcoder.com/tc?module=AlgoRank">Algorithm</a></li>
<li><a href="http://www.topcoder.com/stat?c=top_designers">Design</a></li>
<li><a href="http://www.topcoder.com/stat?c=top_developers">Development</a></li>
<li><a href="http://www.topcoder.com/tc?module=HSRank">High School</a></li>
<li><a href="http://www.topcoder.com/longcontest/stats/?module=CoderRank">Marathon Match</a></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_recordbook')">Record Book</a>
<ul id="m_recordbook">
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=statistics&amp;d2=recordbook_home">Algorithm</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=compstats&amp;d2=comp_recordbook_home">Component</a></li>
<li><a href="http://www.topcoder.com/longcontest/?module=Static&amp;d1=stats&amp;d2=recordbook_home">Marathon Match</a></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_com')">Coder of the Month</a>
<ul id="m_com">
<li><a href="http://www.topcoder.com/tc?module=COMHistory&amp;achtid=5">Algorithm</a></li>
<li><a href="http://www.topcoder.com/tc?module=COMHistory&amp;achtid=6">Design</a></li>
<li><a href="http://www.topcoder.com/tc?module=COMHistory&amp;achtid=7">Development</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_algo_competitions')">Algorithm</a>
<ul id="m_algo_competitions">
<li><a href="javascript:arena();">Launch Arena</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_algo_stats')">Statistics</a>
<ul id="m_algo_stats">
<li><a href="http://www.topcoder.com/tc?module=MatchList">Match Archive</a></li>
<li><a href="http://www.topcoder.com/stat?c=round_overview">Match Overviews</a></li>
<li><a href="http://www.topcoder.com/tc?module=SrmDivisionWins">Match Winners</a></li>
<li><a href="http://www.topcoder.com/stat?c=last_match">Match Results</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=match_editorials&amp;d2=archive">Match Editorials</a></li>
<li><a href="http://www.topcoder.com/tc?module=ProblemArchive">Problem Archive</a></li>
<li><a href="http://www.topcoder.com/tc?module=ColorChange&amp;ratid=1">Recent Color Changes</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Algorithm+Data+Feeds">Data Feeds</a></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_algo_support')">Support / FAQs</a>
<ul id="m_algo_support">
<li><a href="http://www.topcoder.com/wiki/display/tc/How+To+Compete+in+Algorithm+Competitions">How to Compete</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Algorithm+Competition+FAQs">FAQs</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Algorithm+Competition+Rating+System">Rating System</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Write+Problems+for+TopCoder">Write Problems</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_conceptualization_competitions')">Software Conceptualization</a>
<ul id="m_conceptualization_competitions">
<li><a href="http://www.topcoder.com/wiki/display/tc/TopCoder+Conceptualization+Contests">Overview</a></li>
<li><a href="http://www.topcoder.com/tc?module=ActiveContests&amp;pt=23">Active Contests</a></li>
<li><a href="http://www.topcoder.com/tc?module=ContestStatus&amp;pt=23">Contest Status</a></li>
<li><a href="http://software.topcoder.com/review">Submit &amp; Review</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/TopCoder+UML+Tool">UML Tool</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_conceptualization_support')">Support / FAQs</a>
<ul id="m_conceptualization_support">
<li><a href="http://www.topcoder.com/wiki/display/tc/Software+Specification+How+To">How to Compete</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_specification_competitions')">Software Specification</a>
<ul id="m_specification_competitions">
<li><a href="http://www.topcoder.com/wiki/display/tc/TopCoder+Conceptualization+Contests">Overview</a></li>
<li><a href="http://www.topcoder.com/tc?module=ActiveContests&amp;pt=6">Active Contests</a></li>
<li><a href="http://www.topcoder.com/tc?module=ContestStatus&amp;pt=6">Contest Status</a></li>
<li><a href="http://software.topcoder.com/review">Submit &amp; Review</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/TopCoder+UML+Tool">UML Tool</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_specification_support')">Support / FAQs</a>
<ul id="m_specification_support">
<li><a href="http://www.topcoder.com/wiki/display/tc/Software+Specification+How+To">How to Compete</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_architecture_competitions')">Software Architecture</a>
<ul id="m_architecture_competitions">
<li><a href="http://www.topcoder.com/wiki/display/tc/Architecture+Overview">Overview</a></li>
<li><a href="http://www.topcoder.com/tc?module=ActiveContests&amp;pt=7">Active Contests</a></li>
<li><a href="http://www.topcoder.com/tc?module=ContestStatus&amp;pt=7">Contest Status</a></li>
<li><a href="http://www.topcoder.com/tc?module=ViewReviewProjects&amp;pt=7">Review Opportunities</a></li>
<li><a href="http://software.topcoder.com/review">Submit &amp; Review</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/TopCoder+UML+Tool">UML Tool</a></li>
<li><a href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=7">Meet the Review Board</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_architecture_support')">Support / FAQs</a>
<ul id="m_architecture_support">
<li><a href="http://www.topcoder.com/wiki/display/tc/How+to+Compete+in+Architecture+Competitions">How to Compete</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_des_competitions')">Software Design</a>
<ul id="m_des_competitions">
<li><a href="http://www.topcoder.com/tc?module=ViewActiveContests&amp;ph=112">Active Contests</a></li>
<li><a href="http://www.topcoder.com/tc?module=ContestStatus&amp;pt=1">Contest Status</a></li>
<li><a href="http://www.topcoder.com/tc?module=ViewReviewProjects&amp;pt=1">Review Opportunities</a></li>
<li><a href="http://software.topcoder.com/review">Submit &amp; Review</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/TopCoder+UML+Tool">UML Tool</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_des_stats')">Statistics</a>
<ul id="m_des_stats">
<li><a href="http://www.topcoder.com/tc?module=CompList&amp;ph=112">Past Contests</a></li>
<li><a href="http://www.topcoder.com/tc?module=ColorChange&amp;ph=112">Recent Color Changes</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Component+Design+Data+Feeds">Data Feeds</a></li>
</ul></li>
<li><a href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=1">Meet the Review Board</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_des_support')">Support / FAQs</a>
<ul id="m_des_support">
<li><a href="http://www.topcoder.com/wiki/display/tc/How+to+Compete+in+Component+Design+Competitions">How to Compete</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Component+Design+Documentation">Documentation</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Component+Design+Ratings">Ratings</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Component+Design+Reliability+Ratings">Reliability Ratings</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_dev_competitions')">Software Development</a>
<ul id="m_dev_competitions">
<li><a href="http://www.topcoder.com/tc?module=ViewActiveContests&amp;ph=113">Active Contests</a></li>
<li><a href="http://www.topcoder.com/tc?module=ContestStatus&amp;pt=2">Contest Status</a></li>
<li><a href="http://www.topcoder.com/tc?module=ViewReviewProjects&amp;pt=2">Review Opportunities</a></li>
<li><a href="http://software.topcoder.com/review">Submit &amp; Review</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/TopCoder+UML+Tool">UML Tool</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_dev_stats')">Statistics</a>
<ul id="m_dev_stats">
<li><a href="http://www.topcoder.com/tc?module=CompList&amp;ph=113">Past Contests</a></li>
<li><a href="http://www.topcoder.com/tc?module=ColorChange&amp;ph=113">Recent Color Changes</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Component+Development+Data+Feeds">Data Feeds</a></li>
</ul></li>
<li><a href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=2">Meet the Review Board</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_dev_support')">Support / FAQs</a>
<ul id="m_dev_support">
<li><a href="http://www.topcoder.com/wiki/display/tc/How+to+Compete+in+Component+Development+Competitions">How to Compete</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Component+Development+Documentation">Documentation</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Component+Development+Ratings">Ratings</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Component+Development+Reliability+Ratings">Reliability Ratings</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_assembly_competitions')">Software Assembly</a>
<ul id="m_assembly_competitions">
<li><a href="http://www.topcoder.com/wiki/display/tc/Assembly">Overview</a></li>
<li><a href="http://www.topcoder.com/tc?module=ViewAssemblyActiveContests">Active Contests</a></li>
<li><a href="http://www.topcoder.com/tc?module=ContestStatus&amp;pt=14">Contest Status</a></li>
<li><a href="http://www.topcoder.com/tc?module=ViewReviewProjects&amp;pt=14">Review Opportunities</a></li>
<li><a href="http://software.topcoder.com/review">Submit &amp; Review</a></li>
<li><a href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=14">Meet the Review Board</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_assembly_support')">Support / FAQs</a>
<ul id="m_assembly_support">
<li><a href="http://www.topcoder.com/wiki/display/tc/How+to+Compete+in+Assembly+Competitions">How to Compete</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Assembly+Competition+Tutorial">Tutorial</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Assembly+Competition+Documentation">Documentation</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_testing_competitions')">Application Testing</a>
<ul id="m_testing_competitions">
<li><a href="http://www.topcoder.com/wiki/display/tc/Testing">Overview</a></li>
<li><a href="http://www.topcoder.com/tc?module=ActiveContests&amp;pt=13">Active Contests</a></li>
<li><a href="http://www.topcoder.com/tc?module=ContestStatus&amp;pt=13">Contest Status</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_testing_support')">Support / FAQs</a>
<ul id="m_testing_support">
<li><a href="http://www.topcoder.com/wiki/display/tc/How+to+Compete+in+Testing+Competitions">How to Compete</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Testing+Competition+Tutorial">Tutorial</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Testing+Competition+Documentation">Documentation</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_bugraces_competitions')">Bug Races</a>
<ul id="m_bugraces_competitions">
<li><a href="http://www.topcoder.com/wiki/display/tc/Bug+Races">Overview</a></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/Active+Bug+Races">Active Contests</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_bugraces_support')">Support / FAQs</a>
<ul id="m_bugraces_support">
<li><a href="http://www.topcoder.com/wiki/display/tc/How+to+Compete+in+Bug+Races">How to Compete</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_hs_competitions')">High School</a>
<ul id="m_hs_competitions">
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=hs&amp;d2=home">Overview</a></li>
<li><a href="javascript:arena();">Launch Arena</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_hs_stats')">Statistics</a>
<ul id="m_hs_stats">
<li><a href="http://www.topcoder.com/tc?module=HSRoundOverview">Match Overview</a></li>
<li><a href="http://www.topcoder.com/tc?module=HSRoundStatsTeam">Match Results (Team)</a></li>
<li><a href="http://www.topcoder.com/tc?module=HSRoundStatsInd">Match Results (Indiv.)</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=hs&amp;d2=match_editorials&amp;d3=archive">Match Editorials</a></li>
<li><a href="http://www.topcoder.com/tc?module=ColorChange&amp;ratid=2">Recent Color Changes</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=hs&amp;d2=support&amp;d3=dataFeed">Data Feeds</a></li>
</ul></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=hs&amp;d2=sponsorship">Sponsorship</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_hs_support')">Support / FAQs</a>
<ul id="m_hs_support">
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=hs&amp;d2=support&amp;d3=index">How to Compete</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=hs&amp;d2=support&amp;d3=faqIndex">FAQs</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=hs&amp;d2=support&amp;d3=sampleProblems">Sample Problems</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=hs&amp;d2=support&amp;d3=ratings">Rating System</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=help&amp;d2=problemWriter&amp;node=hs_write">Write Problems</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_long_contests')">Marathon Matches</a>
<ul id="m_long_contests">
<li><a href="http://www.topcoder.com/longcontest/?module=ViewActiveContests">Active Contests</a></li>
<li><a href="http://www.topcoder.com/longcontest/?module=ViewPractice">Practice</a></li>
<li><a href="http://www.topcoder.com/longcontest/?module=ViewQueue">Queue Status</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_long_stats')">Statistics</a>
<ul id="m_long_stats">
<li><a href="http://www.topcoder.com/longcontest/stats/?module=MatchList">Match Archive</a></li>
<li><a href="http://www.topcoder.com/longcontest/stats/?module=ViewOverview">Match Overview</a></li>
<li><a href="http://www.topcoder.com/longcontest/stats/?module=MatchWinners">Match Winners</a></li>
<li><a href="http://www.topcoder.com/longcontest/?module=Static&amp;d1=match_editorials&amp;d2=archive">Match Editorials</a></li>
<li><a href="http://www.topcoder.com/longcontest/?module=Static&amp;d1=support&amp;d2=dataFeed">Data Feeds</a></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_long_support')">Support / FAQs</a>
<ul id="m_long_support">
<li><a href="http://www.topcoder.com/longcontest/?module=Static&amp;d1=instructions">How to Compete</a></li>
<li><a href="http://www.topcoder.com/longcontest/?module=Static&amp;d1=support&amp;d2=ratings">Rating System</a></li>
</ul></li>
</ul></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_tournaments')">Tournaments</a>
<ul id="m_tournaments">
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=tournaments&amp;d2=home">TopCoder</a></li>
<li><a href="http://www.topcoder.com/pl/">Powered by TopCoder</a></li>
<li><a href="http://www.topcoder.com/tc?module=CRPFStatic&amp;d1=crpf&amp;d2=crpf_overview">Charity</a></li>
</ul></li>
<li><a href="http://www.topcoder.com/dr">The Digital Run</a></li>
<li class="exp_ed"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_edu_content')">Educational Content</a>
<ul id="m_edu_content" class="OPEN">
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=education&amp;d2=overview">Overview</a></li>
<li class="highlight"><a href="http://www.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=alg_index">Algorithm Tutorials</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=comp_index">Component Tutorials</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=mm_index">Marathon Tutorials</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=features&amp;d2=archive">Features</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=help&amp;d2=writeForTC">Write for TopCoder</a></li>
</ul></li>
<li><a href="http://www.topcoder.com/wiki/display/tc/How+to+Get+Paid+for+Competing">How to Get Paid</a></li>
</ul></li>
<li><a href="http://forums.topcoder.com/">Forums</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=calendar&amp;d2=thisMonth">Event Calendar</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=pressroom&amp;d2=index">Press Room</a></li>
<li><a href="http://www.topcoder.com/tc?&amp;module=SurveyList">Surveys</a></li>
<li><a href="http://www.topcoder.com/tc?module=MyHome">My TopCoder</a></li>
<li class="exp"><a href="javascript:void(0)" onclick="Javascript:toggleMenu(this.parentNode,'m_about_tc')">About TopCoder</a>
<ul id="m_about_tc">
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=index">Overview</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=contactus">Contact Us</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=whyjoin">Why Join TopCoder?</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=jobs">Working at TopCoder</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=management">Management Team</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=terms">Terms, Revisions</a></li>
<li><a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=privacy">Privacy Policy</a></li>
</ul></li></ul>

    <div style="padding: 10px 0px 0px 17px; float: left;">
        
        
        
        
        <a href="http://www.topcoder.com/tc?module=LinkTracking&amp;link=http://software.topcoder.com/&amp;refer=leftnav"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/tc_direct.png" alt="TopCoder Direct"></a>

        
    </div>
    

<div id="navbarSearch">
<b>Member Search:</b>
<form action="http://www.topcoder.com/tc" method="get" name="simpleSearchForm" class="noSpace" id="simpleSearchForm">
   <input class="noSpace" name="module" value="SimpleSearch" type="hidden">
   <input class="noSpace" name="ha" value="Handle:" size="12" maxlength="15" onfocus="javascript: if (document.simpleSearchForm.ha.value=='Handle:') document.simpleSearchForm.ha.value = '';" onblur="javascript:if (document.simpleSearchForm.ha.value == '')document.simpleSearchForm.ha.value = 'Handle:';" type="text">
   <a class="gMetal" href="javascript:void%20document.simpleSearchForm.submit();">Go</a><br>
   <a class="gMetal" href="http://www.topcoder.com/tc?module=ViewAdvanced">Advanced Search</a>
</form>
</div>
</div>
<div style="padding: 0px 0px 23px; float: left; clear: left;"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/leftnav_bottom.gif" alt=""></div>


    <div style="margin: 0px; float: left; clear: left; width: 170px;" align="center">
        <img src="Introduction%20to%20String%20Searching%20Algorithms_files/brackets.png" alt="" style="margin-bottom: 23px;">
    </div>



        </td>
        <!-- Left Column Ends -->
        <!-- Center Column Begins -->
        <td align="center" width="100%"><div class="tutorBodyFull">
            




<table class="pageTitleTable" cellpadding="0" cellspacing="0">
    <tbody><tr>
        <td class="pageTitle" width="100%"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/header_alg_tut.gif" alt="alg_tut" border="0"></td>
        <td class="pageSubtitle" align="right">&nbsp;&nbsp;</td>
    </tr>
</tbody></table>


            <div class="linkBox"> <a href="http://www.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=alg_index">Archive</a><br>
                <span id="printableLink"><a href="javascript:makeInvisible();">Printable view</a><br>
                </span> <span id="navigableLink" class="invisible"><a href="javascript:makeNavigable();">Normal view</a><br>
                </span>
                <a href="http://forums.topcoder.com/?module=ThreadList&amp;forumID=516215">Discuss this article</a><br>
                <a href="http://www.topcoder.com/tc?module=Static&amp;d1=help&amp;d2=writeForTC">Write for TopCoder</a>
            </div>
            
            <span class="bigTitle">Introduction to String Searching Algorithms</span><br>
            <span class="bodySubtitle">Rabin-Karp and Knuth-Morris-Pratt Algorithms</span>
            <br><br>

            <div class="authorPhoto">
                <img src="Introduction%20to%20String%20Searching%20Algorithms_files/TheLlama_big.jpg" alt="Author">
            </div>

            <div class="authorText"> By&nbsp;<a href="http://www.topcoder.com/tc?module=MemberProfile&amp;cr=14926760" class="coderTextYellow">TheLlama</a><br>
                <em>TopCoder Member</em>
            </div>

            <br clear="all">

<p>The fundamental string searching (matching) problem is defined as
follows: given two strings - a text and a pattern, determine whether
the pattern appears in the text. The problem is also known as "the
needle in a haystack problem."</p>

<p><span class="bodySubtitle">The "Naive" Method</span><br>
Its idea is straightforward -- for every position in the text, consider
it a starting position of the pattern and see if you get a match.</p>

<pre class="code">function brute_force(text[], pattern[]) 
{
  // let n be the size of the text and m the size of the
  // pattern

  for(i = 0; i &lt; n; i++) {
    for(j = 0; j &lt; m &amp;&amp; i + j &lt; n; j++) 
      if(text[i + j] != pattern[j]) break;
      // mismatch found, break the inner loop
    if(j == m) // match found
  }
}
</pre>

<p>The "naive" approach is easy to understand and implement but it can
be too slow in some cases. If the length of the text is n and the
length of the pattern m, in the worst case it may take as much as (n *
m) iterations to complete the task.</p>

<p>It should be noted though, that for most practical purposes, which
deal with texts based on human languages, this approach is much faster
since the inner loop usually quickly finds a mismatch and breaks. A
problem arises when we are faced with different kinds of "texts," such
as the genetic code.</p>

<p><span class="bodySubtitle">Rabin-Karp Algorithm (RK)</span><br>
This is actually the "naive" approach augmented with a powerful programming technique - the hash function. </p>

<p>Every string s[] of length m can be seen as a number H written in a
positional numeral system in base B (B &gt;= size of the alphabet used
in the string):</p>

<p><strong>H = s[0] * B<sup>(m - 1)</sup>  + s[1] * B<sup>(m - 2)</sup> + &#8230; + s[m - 2] * B<sup>1</sup> + s[m - 1] * B<sup>0</sup></strong></p>

<p>If we calculate the number H (the hash value) for the pattern and
the same number for every substring of length m of the text than the
inner loop of the "naive" method will disappear - instead of comparing
two strings character by character we will have just to compare two
integers.</p>

<p>A problem arises when m and B are big enough and the number H
becomes too large to fit into the standard integer types. To overcome
this, instead of the number H itself we use its remainder when divided
by some other number M. To get the remainder we do not have to
calculate H. Applying the basic rules of modular arithmetic to the
above expression: </p>

<p><strong>A + B = C   =&gt;   (A % M + B % M) % M = C % M<br>
A * B = C   =&gt;   ((A % M) * (B % M)) % M = C % M</strong></p>

<p>We get:</p>

<p><strong>H % M = (((s[0] % M) * (B<sup>(m - 1)</sup> % M)) % M + ((s[1] % M) * (B<sup>(m - 2)</sup> % M)) % M  +&#8230;<br>

        &#8230;+ ((s[m - 2] % M) * (B<sup>1</sup> % M)) % M + ((s[m - 1] % M) * (B<sup>0</sup> % M)) % M) % M</strong></p>

<p>The drawback of using remainders is that it may turn out that two
different strings map to the same number (it is called a collision).
This is less likely to happen if M is sufficiently large and B and M
are prime numbers. Still this does not allow us to entirely skip the
inner loop of the "naive" method. However, its usage is significantly
limited. We have to compare the "candidate" substring of the text with
the pattern character by character only when their hash values are
equal.</p>

<p>Obviously the approach described so far would be absolutely useless
if we were not able to calculate the hash value for every substring of
length m in the text in just one pass through the entire text. At first
glance to do these calculations we will again need two nested loops: an
outer one -- to iterate through all possible starting positions -- and
an inner one -- to calculate the hash function for every starting
position. Fortunately, this is not the case. Let's consider a string
s[], and let's suppose we are to calculate the hash value for every
substring in s[] with length say m = 3. It is easy to see that:</p>

<p><strong>H<sub>0</sub>  =  H<sub>s[0]&#8230;s[2]</sub>  =  s[0] * B<sup>2</sup>  + s[1] * B + s[2]</strong></p>
   
<p><strong>H<sub>1</sub>  =  H<sub>s[1]..s[3]</sub>   =  s[1] * B<sup>2</sup>  + s[2] * B + s[3]</strong></p>

<p><strong>H<sub>1</sub>  =  (H<sub>0</sub>  - s[0] * B<sup>2</sup> ) * B + s[3]</strong></p>

<p>In general:</p>

<p><strong>H<sub>i</sub>  =  ( H<sub>i - 1</sub>  - s[i- 1] * B<sup>m - 1</sup> ) * B + s[i + m - 1]</strong></p>

<p>Applying again the rules of modular arithmetic, we get:</p>

<p><strong>H<sub>i</sub>  % M  =  (((( H<sub>i - 1</sub>  % M  - ((s[i- 1]  % M) * (B<sup>m - 1</sup> % M)) % M ) % M) * (B % M))  % M +  <br>
                          + s[i + m - 1] % M) % M</strong></p>

<p>Obviously the value of (H<sub>i - 1</sub> - s[i - 1] * B<sup>m - 1</sup>) may be negative. Again, the rules of modular arithmetic come into play:</p>

<p><strong>A - B = C   =&gt;   (A % M - B % M + k * M) % M = C % M</strong></p>

<p>Since the absolute value of (H<sub>i - 1</sub> - s[i - 1] * B<sup>m - 1</sup>) is between 0 and (M - 1), we can safely use a value of 1 for k.</p>

<p>Pseudocode for RK follows:</p>

<pre class="code">// correctly calculates a mod b even if a &lt; 0
function int_mod(int a, int b)
{
  return (a % b + b) % b;
}

function Rabin_Karp(text[], pattern[])
{
  // let n be the size of the text, m the size of the
  // pattern, B - the base of the numeral system,
  // and M - a big enough prime number

  if(n &lt; m) return; // no match is possible

  // calculate the hash value of the pattern
  hp = 0;
  for(i = 0; i &lt; m; i++) 
    hp = int_mod(hp * B + pattern[i], M);

  // calculate the hash value of the first segment 
  // of the text of length m
  ht = 0;
  for(i = 0; i &lt; m; i++) 
    ht = int_mod(ht * B + text[i], M);

  if(ht == hp) check character by character if the first
               segment of the text matches the pattern;

  // start the "rolling hash" - for every next character in
  // the text calculate the hash value of the new segment
  // of length m; E = (Bm-1) modulo M            
  for(i = m; i &lt; n; i++) {
    ht = int_mod(ht - int_mod(text[i - m] * E, M), M);
    ht = int_mod(ht * B, M);
    ht = int_mod(ht + text[i], M);

    if(ht == hp) check character by character if the
                 current segment of the text matches
                 the pattern; 
  }
}
</pre>

<p>Unfortunately, there are still cases when we will have to run the
entire inner loop of the "naive" method for every starting position in
the text -- for example, when searching for the pattern "aaa" in the
string "aaaaaaaaaaaaaaaaaaaaaaaaa" -- so in the worst case we will
still need (n * m) iterations. How do we overcome this? </p>

<p>Let's go back to the basic idea of the method -- to replace the
string comparison character by character by a comparison of two
integers. In order to keep those integers small enough we have to use
modular arithmetic. This causes a "side effect" -- the mapping between
strings and integers ceases to be unique. So now whenever the two
integers are equal we still have to "confirm" that the two strings are
identical by running character-by-character comparison. It can become a
kind of vicious circle&#8230;</p>

<p>The way to solve this problem is "rational gambling," or the so
called "double hash" technique. We "gamble" -- whenever the hash values
of two strings are equal, we assume that the strings are identical, and
do not compare them character by character. To make the likelihood of a
"mistake" negligibly small we compute for every string not one but two
independent hash values based on different numbers B and M. If both are
equal, we assume that the strings are identical. Sometimes even a
"triple hash" is used, but this is rarely justifiable from a practical
point of view.</p>

<p>The "pure" form of "the needle in a haystack problem" is considered
too straightforward and is rarely seen in programming contests.
However, the "rolling hash" technique used in RK is an important
weapon. It is especially useful in problems where we have to look at
all substrings of fixed length of a given text. An example is "the
longest common substring problem": given two strings find the longest
string that is a substring of both. In this case, the combination of
binary search (BS) and "rolling hash" works quite well. The important
point that allows us to use BS is the fact that if the given strings
have a common substring of length n, they also have at least one common
substring of any length m &lt; n. And if the two strings do not have a
common substring of length n they do not have a common substring of any
length m &gt; n. So all we need is to run a BS on the length of the
string we are looking for. For every substring of the first string of
the length fixed in the BS we insert it in a hash table using one hash
value as an index and a second hash value ("double hash") is inserted
in the table. For every substring of the fixed length of the second
string, we calculate the corresponding two hash values and check in the
table to see if they have been already seen in the first string. A hash
table based on open addressing is very suitable for this task.</p>

<p>Of course in "real life" (real contests) the number of the given
strings may be greater than two, and the longest substring we are
looking for should not necessarily be present in all the given strings.
This does not change the general approach.</p>

<p>Another type of problems where the "rolling hash" technique is the
key to the solution are those that ask us to find the most frequent
substring of a fixed length in a given text. Since the length is
already fixed we do not need any BS. We just use a hash table and keep
track of the frequencies. </p>

<p><span class="bodySubtitle">Knuth-Morris-Pratt Algorithm (KMP)</span><br>
In some sense, the "naive" method and its extension RK reflect the
standard approach of human logic to "the needle in a haystack problem".
The basic idea behind KMP is a bit different. Let's suppose that we are
able, after one pass through the text, to identify all positions where
an existing match with the pattern ends. Obviously, this will solve our
problem. Since we know the length of the pattern, we can easily
identify the starting position of every match.</p>

<p>Is this approach feasible? It turns out that it is, when we apply
the concept of the automaton. We can think of an automaton as of a kind
of abstract object, which can be in a finite number of states. At each
step some information is presented to it. Depending on this information
and its current state the automaton goes to a new state, uniquely
determined by a set of internal rules. One of the states is considered
as "final". Every time we reach this "final" state we have found an end
position of a match.</p>

<p>The automaton used in KMP is just an array of "pointers" (which
represents the "internal rules") and a separate "external" pointer to
some index of that array (which represents the "current state"). When
the next character from the text is presented to the automaton, the
position of the "external" pointer changes according to the incoming
character, the current position, and the set of "rules" contained in
the array. Eventually a "final" state is reached and we can declare
that we have found a match.</p>

<p>The general idea behind the automaton is relatively simple. Let us consider the string</p>

<p><strong> A B A B A C</strong></p>

<p>as a pattern, and let's list all its prefixes:</p>

<p><strong>0     /the empty string/<br>
1     A<br>
2     A B<br>
3     A B A<br>
4     A B A B<br>
5     A B A B A<br>
6     A B A B A C</strong></p>

<p>Let us now consider for each such listed string (prefix) the longest
proper suffix (a suffix different from the string itself), which is at
the same time a prefix of it: </p>

<p><strong>0     /the empty string/<br>
1     /the empty string/<br>
2     /the empty string/<br>
3     A<br>
4     A B<br>
5     A B A<br>
6     /the empty string/</strong></p>

<p>It's easy to see that if we have at some point a partial match up to
say the prefix (A B A B A) we also have a partial match up to the
prefixes (A B A), and (A) - which are both prefixes of the initial
string and suffix/prefixes of the current match. Depending on the next
"incoming" character from the text, three cases arise:</p>

<ol>
	<li>The next character is C. We can "expand" the match at the
level of the prefix (A B A B A). In this particular case this leads to
a full match and we just notice this fact. </li>
	<li>The next
character is B. The partial match for the prefix (A B A B A) cannot be
"expanded". The best we can do is to return to the largest different
partial match we have so far - the prefix (A B A) and try to "expand"
it. Now B "fits" so we continue with the next character from the text
and our current "best" partial match will become the string (A B A B)
from our "list of prefixes".</li>
 	<li>The "incoming" character is,
for example, D. The "journey" back to (A B A) is obviously insufficient
to "expand" the match. In this case we have to go further back to the
second largest partial match (the second largest proper suffix of the
initial match that is at the same time a prefix of it) - that is (A)
and finally to the empty string (the third largest proper suffix in our
case). Since it turns out that there is no way to "expand" even the
empty string using the character D, we skip D and go to the next
character from the text. But now our "best" partial match so far will
be the empty string.</li>
</ol>

<p>In order to build the KMP automaton (or the so called KMP "failure
function") we have to initialize an integer array F[]. The indexes
(from 0 to m - the length of the pattern) represent the numbers under
which the consecutive prefixes of the pattern are listed in our "list
of prefixes" above. Under each index is a "pointer" - that identifies
the index of the longest proper suffix, which is at the same time a
prefix of the given string (or in other words F[i] is the index of next
best partial match for the string under index i). In our case (the
string A B A B A C) the array F[] will look as follows:</p>

<p><strong>F[0] = 0<br>
F[1] = 0<br>
F[2] = 0<br>
F[3] = 1<br>
F[4] = 2<br>
F[5] = 3<br>
F[6] = 0</strong></p>

<p>Notice that after initialization F[i] contains information not only
about the largest next partial match for the string under index i but
also about every partial match of it. F[i] is the first best partial
match, F[F[i]] - is the second best, F[F[F[i]]] - the third, and so on.
Using this information we can calculate F[i] if we know the values F[k]
for all k &lt; i. The best next partial match of string i will be the
largest partial match of string i - 1 whose character that "expands" it
is equal to the last character of string i. So all we need to do is to
check every partial match of string i - 1 in descending order of length
and see if the last character of string i "expands" the match at this
level. If no partial match can be "expanded" than F[i] is the empty
string. Otherwise F[i] is the largest "expanded" partial match (after
its "expansion").</p>

<p>In terms of pseudocode the initialization of the array F[] (the "failure function") may look like this:</p>

<pre class="code">// Pay attention! 
// the prefix under index i in the table above is 
// is the string from pattern[0] to pattern[i - 1] 
// inclusive, so the last character of the string under 
// index i is pattern[i - 1]   

function build_failure_function(pattern[])
{
  // let m be the length of the pattern 

  F[0] = F[1] = 0; // always true
  
  for(i = 2; i &lt;= m; i++) {
    // j is the index of the largest next partial match 
    // (the largest suffix/prefix) of the string under  
    // index i - 1
    j = F[i - 1];
    for( ; ; ) {
      // check to see if the last character of string i - 
      // - pattern[i - 1] "expands" the current "candidate"
      // best partial match - the prefix under index j
      if(pattern[j] == pattern[i - 1]) { 
        F[i] = j + 1; break; 
      }
      // if we cannot "expand" even the empty string
      if(j == 0) { F[i] = 0; break; }
      // else go to the next best "candidate" partial match
      j = F[j];
    }
  }   
}
</pre>

<p>The automaton consists of the initialized array F[] ("internal
rules") and a pointer to the index of the prefix of the pattern that is
the best (largest) partial match that ends at the current position in
the text ("current state"). The use of the automaton is almost
identical to what we did in order to build the "failure function". We
take the next character from the text and try to "expand" the current
partial match. If we fail, we go to the next best partial match of the
current partial match and so on. According to the index where this
procedure leads us, the "current state" of the automaton is changed. If
we are unable to "expand" even the empty string we just skip this
character, go to the next one in the text, and the "current state"
becomes zero.</p>

<pre class="code">function Knuth_Morris_Pratt(text[], pattern[])
{
  // let n be the size of the text, m the 
  // size of the pattern, and F[] - the
  // "failure function"

  build_failure_function(pattern[]); 

  i = 0; // the initial state of the automaton is
         // the empty string

  j = 0; // the first character of the text
  
  for( ; ; ) {
    if(j == n) break; // we reached the end of the text

    // if the current character of the text "expands" the
    // current match 
    if(text[j] == pattern[i]) {
      i++; // change the state of the automaton
      j++; // get the next character from the text
      if(i == m) // match found
    }

    // if the current state is not zero (we have not
    // reached the empty string yet) we try to
    // "expand" the next best (largest) match
    else if(i &gt; 0) i = F[i];

    // if we reached the empty string and failed to
    // "expand" even it; we go to the next 
    // character from the text, the state of the
    // automaton remains zero
    else j++;
  }
}
</pre>

<p>Many problems in programming contests focus more on the properties
of KMP's "failure function," rather than on its use for string
matching. An example is: given a string (a quite long one), find all
its proper suffixes that are also prefixes of it. All we have to do is
just to calculate the "failure function" of the given string and using
the information stored in it to print the answer.</p>

<p>A typical problem seen quite often is: given a string find its
shortest substring, such that the concatenation of one or more copies
of it results in the original string. Again the problem can be reduced
to the properties of the failure function. Let's consider the string</p>

<p><strong>A B A B A B</strong></p>

<p>and all its proper suffix/prefixes in descending order:</p>

<p><strong>1   A B A B<br>
2   A B<br>
3   /the empty string/</strong></p>

<p>Every such suffix/prefix uniquely defines a string, which after
being "inserted" in front of the given suffix/prefix gives the initial
string. In our case:</p>

<p><strong>1   A B<br>
2   A B A B<br>
3   A B A B A B</strong></p>

<p>Every such "augmenting" string is a potential "candidate" for a
string, the concatenation of several copies of which results in the
initial string. This follows from the fact that it is not only a prefix
of the initial string but also a prefix of the suffix/prefix it
"augments". But that means that now the suffix/prefix contains at least
two copies of the "augmenting" string as a prefix (since it's also a
prefix of the initial string) and so on. Of course if the suffix/prefix
under question is long enough. In other words, the length of a
successful "candidate" must divide with no remainder the length of the
initial string.</p>

<p>So all we have to do in order to solve the given problem is to
iterate through all proper suffixes/prefixes of the initial string in
descending order. This is just what the "failure function" is designed
for. We iterate until we find an "augmenting" string of the desired
length (its length divides with no remainder the length of the initial
string) or get to the empty string, in which case the "augmenting"
string that meets the above requirement will be the initial string
itself.</p>

<p><span class="bodySubtitle">Rabin-Karp and Knuth-Morris-Pratt at TopCoder</span><br>
In the problem types mentioned above, we are dealing with relatively
"pure" forms of RK, KMP and the techniques that are the essence of
these algorithms. While you're unlikely to encounter these pure
situations in a TopCoder SRM, the drive towards ever more challenging
TopCoder problems can lead to situations where these algorithms appear
as one level in complex, "multilayer" problems. The specific input size
limitations favor this trend, since we will not be presented as input
with multimillion character strings, but rather with a "generator",
which may be by itself algorithmic in nature. A good example is "<a href="http://www.topcoder.com/stat?c=problem_statement&amp;pm=6017&amp;rd=8083">InfiniteSoup</a>," Division 1 - Level Three, SRM 286.</p>

            <p>&nbsp; </p>
            <br>
            <br>
        </div></td>
        <!-- Center Column Ends -->
        <!-- Right Column Begins -->
        <td id="onRight" width="170">



<script type="text/javascript" language="javascript">

</script>



<div class="rightColContent">
    <br><br>
</div>


        </td>
        <!-- Right Column Ends -->
        <!-- Gutter -->
        <td width="10"><img src="Introduction%20to%20String%20Searching%20Algorithms_files/clear.gif" border="0" width="10" height="1"></td>
        <!-- Gutter Ends -->
    </tr>
</tbody></table>
<div id="onBottom">
    

<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody>
    <tr>
        <td class="footer" width="100%">
            <a href="http://www.topcoder.com/" class="footerLinks">Home</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=index" class="footerLinks">About TopCoder</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href="http://www.topcoder.com/tc?module=Static&amp;d1=pressroom&amp;d2=index" class="footerLinks">Press Room</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=contactus" class="footerLinks">Contact Us</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=jobs" class="footerLinks">Careers</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=privacy" class="footerLinks">Privacy</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href="http://www.topcoder.com/tc?module=Static&amp;d1=about&amp;d2=terms" class="footerLinks">Terms</a>
            <br>
            <a href="http://www.topcoder.com/tc" class="footerLinks">Competitions</a>&nbsp;&nbsp;|&nbsp;&nbsp;
            <a href="http://software.topcoder.com/" class="footerLinks">Software</a>        </td>
    </tr>
    <tr><td class="copyright" width="100%">Copyright  2001-2008, TopCoder, Inc. All rights reserved.</td></tr>
</tbody>
</table>


<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="Introduction%20to%20String%20Searching%20Algorithms_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6340959-1");
pageTracker._trackPageview();
</script>
</div>
</body></html>